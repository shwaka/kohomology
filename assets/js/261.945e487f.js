(()=>{"use strict";var e,t,s={7261:(e,t,s)=>{class a extends Error{constructor(e,t=`Unsupported type: ${e}`){super(t)}}const r=["text","math"],o=["success","error"];function n(e,t){return{messageType:e,strings:[{stringType:"text",content:t}],plainString:t,options:[{text:t,label:"Copy this line"}]}}var i=s(4921);function p(e){const t=e.stringType;if(!r.includes(t))throw new Error(`Invalid stringType: ${t}`);return{stringType:t,content:e.content}}function l(e){const t=[{text:e.plainString,label:"Copy this line"}];return null!==e.dgaJson&&void 0!==e.dgaJson&&t.push({text:e.dgaJson,label:"Copy this DGA as JSON"}),t}function u(e){const t=e.messageType;if(!o.includes(t))throw new Error(`Invalid messageType: ${t}`);return{messageType:t,strings:e.strings.map(p),plainString:e.plainString,options:l(e.options)}}class d{dgaWrapper=null;constructor(e,t,s,a){this.log=s??((...e)=>console.log(...e)),this.error=a??((...e)=>console.error(...e)),this.postMessage=t=>{this.log("WorkerOutput",t),e(t)},this.updateState=(...e)=>{this.log("updateState",...e),t(...e)},this.log("new KohomologyMessageHandler()")}onmessage(e){this.log("WorkerInput",e),this.notifyInfo({status:"computing",progress:null});try{switch(e.command){case"updateJson":this.updateJson(e.json),this.updateIdealJson("[]"),this.showDgaInfo(),this.showIdealInfo();break;case"updateIdealJson":this.updateIdealJson(e.idealJson),this.showIdealInfo();break;case"computeCohomology":this.computeCohomology(e.targetName,e.minDegree,e.maxDegree,e.showCohomology);break;case"computeCohomologyClass":this.computeCohomologyClass(e.targetName,e.cocycleString,e.showBasis);break;case"computeMinimalModel":this.computeMinimalModel(e.targetName,e.isomorphismUpTo);break;default:throw new a(e,`Invalid command: ${e}`)}}catch(t){t instanceof Error&&this.sendMessages(n("error",t.message)),this.error(t)}finally{this.notifyInfo({status:"idle"})}}updateJson(e){try{this.dgaWrapper=new i.FreeDGAWrapper(e),this.updateState("json",e)}catch(t){throw this.dgaWrapper=null,t}}updateIdealJson(e){g(this.dgaWrapper,"dgaWrapper is null"),this.dgaWrapper.setIdeal(e),this.updateState("idealJson",e)}sendMessages(e){if(e instanceof Array){const t={command:"printMessages",messages:e};this.postMessage(t)}else{const t={command:"printMessages",messages:[e]};this.postMessage(t)}}notifyInfo(e){this.updateState("workerInfo",e)}computeCohomology(e,t,s,a){g(this.dgaWrapper,"dgaWrapper is null"),this.sendMessages(u(this.dgaWrapper.computationHeader(e,t,s))),this.notifyInfo({status:"computing",progress:0});let r=[],o=(new Date).getTime();for(let n=t;n<=s;n++){switch(a){case"basis":r.push(u(this.dgaWrapper.computeCohomology(e,n)));break;case"dim":r.push(u(this.dgaWrapper.computeCohomologyDim(e,n)))}const i=(new Date).getTime();if(i-o>500){o=i,this.sendMessages(r);const e=(n-t+1)/(s-t+1);this.notifyInfo({status:"computing",progress:e}),r=[]}}this.sendMessages(r)}computeCohomologyClass(e,t,s){g(this.dgaWrapper,"dgaWrapper is null"),this.notifyInfo({status:"computing",progress:null}),this.sendMessages(u(this.dgaWrapper.computeCohomologyClass(e,t,s)))}computeMinimalModel(e,t){g(this.dgaWrapper,"dgaWrapper is null"),this.notifyInfo({status:"computing",progress:null});this.sendMessages(this.dgaWrapper.computeMinimalModel(e,t,((e,t,s)=>{this.updateState("workerInfo",{status:"computing",progress:0!==t?e/t:1,message:`Completed degree ${e}/${t}, Generators: ${s}`})})).map(u))}showDgaInfo(){if(null===this.dgaWrapper){const e="[Error] Your DGA contains errors. Please fix them.";this.updateState("dgaInfo",[n("error",e)])}else this.updateState("dgaInfo",this.dgaWrapper.dgaInfo().map(u))}showIdealInfo(){g(this.dgaWrapper,"dgaWrapper is null"),this.updateState("idealInfo",u(this.dgaWrapper.idealInfo()))}validateIdealGenerator(e){g(this.dgaWrapper,"dgaWrapper is null");const t=(0,i.validateIdealGeneratorString)(this.dgaWrapper,e);switch(t.type){case"success":return!0;case"error":return t.message;default:throw new Error("This can't happen!")}}validateIdealGeneratorArray(e){g(this.dgaWrapper,"dgaWrapper is null");const t=JSON.stringify(e),s=(0,i.validateIdealJson)(this.dgaWrapper,t);switch(s.type){case"success":return!0;case"error":return s.message;default:throw new Error("This can't happen!")}}}function g(e,t){if(null===e)throw new Error(t)}const h=self,c=function(e,t){const s=t({postWorkerOutput:t=>{e({type:"output",value:t})},updateState:(...t)=>{const s=t[0],a=t[1];e({type:"updateState",key:s,value:a})}});return{onmessage:t=>{const r=t.data;switch(r.type){case"input":return void s.onWorkerInput(r.value);case"callFunc":return void(t=>{const a=s.workerFunc[t.key](...t.args),r={type:"funcResult",key:t.key,result:a,id:t.id};e(r)})(r);default:throw new a(r,"onmessage is not exhaustive!")}}}}(h.postMessage.bind(h),(({postWorkerOutput:e,updateState:t})=>{const s=new d(e,t);return{onWorkerInput:e=>s.onmessage(e),workerFunc:{validateIdealGenerator:e=>s.validateIdealGenerator(e),validateIdealGeneratorArray:e=>s.validateIdealGeneratorArray(e)}}}));onmessage=c.onmessage}},a={};function r(e){var t=a[e];if(void 0!==t)return t.exports;var o=a[e]={exports:{}};return s[e].call(o.exports,o,o.exports,r),o.exports}r.m=s,r.x=()=>{var e=r.O(void 0,[921],(()=>r(7261)));return e=r.O(e)},e=[],r.O=(t,s,a,o)=>{if(!s){var n=1/0;for(u=0;u<e.length;u++){s=e[u][0],a=e[u][1],o=e[u][2];for(var i=!0,p=0;p<s.length;p++)(!1&o||n>=o)&&Object.keys(r.O).every((e=>r.O[e](s[p])))?s.splice(p--,1):(i=!1,o<n&&(n=o));if(i){e.splice(u--,1);var l=a();void 0!==l&&(t=l)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[s,a,o]},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((t,s)=>(r.f[s](e,t),t)),[])),r.u=e=>"assets/js/"+e+".55baf0d8.js",r.miniCssF=e=>{},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.p="/kohomology/",r.gca=function(e){return e={}[e]||e,r.p+r.u(e)},(()=>{var e={261:1};r.f.i=(t,s)=>{e[t]||importScripts(r.p+r.u(t))};var t=self.webpackChunkwebsite=self.webpackChunkwebsite||[],s=t.push.bind(t);t.push=t=>{var a=t[0],o=t[1],n=t[2];for(var i in o)r.o(o,i)&&(r.m[i]=o[i]);for(n&&n(r);a.length;)e[a.pop()]=1;s(t)}})(),t=r.x,r.x=()=>r.e(921).then(t);r.x()})();